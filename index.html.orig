<!doctype html> 
    <html lang="en"> 
    <head> 
        <meta charset="UTF-8" />
        <title>Video Game</title>
        <style type="text/css">
            body {
                margin: 0;
            }
        </style>
        <script src="phaser.js"></script>
    </head>
    <body>
        <script type="text/javascript">
            var config = {
                type: Phaser.AUTO,
                width: 800,
                height: 600,
                physics: {
                    default: 'arcade',
                    arcade: {
                        gravity: { y: 300 },
                        debug: false
                    }
                },
                scene: {
                    preload: preload,
                    create: create,
                    update: update
                }
            };

            var player;
            var stars;
            var spikes;
            var cursors;
            var score = 0;
            var gameOver = false;
            var scoreText;
            var timer;
            var game = new Phaser.Game(config);

            function preload(){
                this.load.image('background', 'assets/background.png');
                this.load.image('star', 'assets/star.png');
                this.load.image('rightSpike', 'assets/rightSpike.png');
                this.load.image('leftSpike', 'assets/leftSpike.png');
                this.load.image('ball', 'assets/ball.png');
            }

            function create(){
                // Background
                this.add.image(400, 300, 'background');

                // The spikes group contains 3 leftSpikes and 3 rightSpikes, with random "y" positions
                spikes = this.physics.add.staticGroup();
                createSpikes(spikes);

                // The player and its settings
                player = this.physics.add.sprite(370, 50, 'ball');
                player.displayWidth = 50;
                player.displayHeight = 50;
                player.setBounce(0.2);
                player.setCollideWorldBounds(true);

                // Input Events
                cursors = this.input.keyboard.createCursorKeys();

                // Stars
                stars = this.physics.add.staticGroup();
                for (var i = 0; i < 3; i++) {
                    stars.create((Math.round(Math.random() * (750 - 50)) + 50), (Math.round(Math.random() * (550 - 70)) + 70), 'star');
                }

                // The score
                scoreText = this.add.text(16, 16, 'Score: 0', { fontSize: '32px', fill: '#f00' });

                // Checks to see if the player overlaps with any of the stars, if he does call the collectStar function
                this.physics.add.overlap(player, stars, collectStar, null, this);

                // Checks to see if the player collides with any of the spikes, if he does call the hitSpike function
                this.physics.add.collider(player, spikes, hitSpike, null, this);
            }

            function update(){
                if (gameOver){
                    return;
                }

                if (cursors.left.isDown){
                    player.setVelocityX(-160);
                }

                else if (cursors.right.isDown){
                    player.setVelocityX(160);
                }

                else{
                    player.setVelocityX(0);
                }

                if (cursors.up.isDown){
                    player.setVelocityY(-200);
                }
            }

            function collectStar(player, star){
                star.disableBody(true, true);

                //  Add and update the score
                score += 10;
                scoreText.setText('Score: ' + score);

                // If we catch all the star, we create 3 more
                if (stars.countActive(true) === 0){
                    createSpikes(spikes);
                    for (var i = 0; i < 3; i++) {
                        stars.create((Math.round(Math.random() * (750 - 50)) + 50), (Math.round(Math.random() * (550 - 70)) + 70), 'star');
                    }
                }
            }

            function createSpikes(spikes){
                for (var i = 0; i < 3; i++) {
                    spikes.create(80, (Math.round(Math.random() * (560 - 40)) + 40), 'leftSpike').setScale(0.8);
                }
                for (var i = 0; i < 3; i++) {
                    spikes.create(720, (Math.round(Math.random() * (550 - 50)) + 50), 'rightSpike').setScale(0.8);
                }
            }

            function hitSpike(player, spike){
                this.physics.pause();
                player.setTint(0x00000);
                gameOver = true;
            }
        </script>
    </body>
</html>